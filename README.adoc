= Polkabot
:toc:
:proj: PolkaBOT
:exe: polkabot

image:https://gitlab.com/chevdor/polkabot/badges/master/pipeline.svg[link="https://gitlab.com/chevdor/polkabot/commits/master",title="pipeline status"]
image:https://gitlab.com/chevdor/polkabot/badges/master/coverage.svg[link="https://gitlab.com/chevdor/polkabot/commits/master",title="coverage report"]

== Intro

image::doc/polkabot.png[width=300px]

You can see {proj} in action in link:++https://matrix.to/#/#polkadot-network-status:matrix.org++[#polkadot-network-status:matrix.org]

Polkabot is an extensible bot for http://polkadot.network[Polkadot], running on http://matrix.org[Matrix.org]

NOTE: {proj} aims as being *as silent as possible* so don't expect lots of fuzz and action!

== Install & Run

	git clone https://gitlab.com/chevdor/polkabot.git
	cd polkabot
	yarn

At that point, you will need to search for the `config-sample.js` files. Everywhere you find one, create a `config.js` and make sure you adapt the content. Once you think you are good:

	yarn start

== Docker images

To build the base and the custom:

	yarn build:docker

This will build the {proj} main image.

Then, test with :

----
docker run --rm -it -v ~/path/to/your/config.js:/data/config.js chevdor/polkabot npm start -- --config /data/config.js
----

== Configuration

{proj} uses 2 levels of configuration:
- the main config in src/config.js
- the plugin specific config in `src/plugins/.../config.js`


include::CONTRIBUTING.adoc[]


=== Create plugins

Once you picked a name for your plugin, create a folder in `src/plugin`.

Your plugin can start with code similar to:

[source, js, indent=0, linenums]
----
include::doc/plugin.js[]
----

== Plugins

You can all the plugins in https://gitlab.com/Polkabot

== Dev notes

	yarn
	yarn-check
	yarn upgrade

Start your substrate node:

	docker run --rm -it chevdor/substrate substrate --dev

then run:

	nvm use

Before you got further you need to check your config. This is a .env file and all variables start with `POLKABOT_`. 
By default, the running mode is 'production' and will pick the `.env` file. The following to the same:

	yarn start
	NODE_ENV=production yarn start
	
If you want to use another file such as `.env.dev`, you may use:

	NODE_ENV=dev y start

